# Policy Paper Theme & Cluster Analysis (Martens Centre)

This project conducts a comprehensive text analysis of policy papers published by the Wilfried Martens Centre for European Studies. Using a combination of Natural Language Processing (NLP), semantic embeddings, clustering, and keyword extraction, the notebook identifies thematic structures and content patterns across a body of policy research.

---

## Objectives

- **Clean** and preprocess raw full-text PDF documents.
- **Detect dominant themes** in each paper using sentence embeddings.
- **Cluster** themes into higher-level topic areas.
- **Visualize** theme co-occurrence, distribution by cluster, and representative keywords.
- **Export** structured CSV summaries for further reporting or visual use.

---

## Scripts Overview

The following Python scripts are provided in the `scripts/` directory to replicate the data acquisition process:

- `download_martens_pdfs.py`: Downloads policy paper PDFs from Martens Centre.
- `download_multi_pdfs.py`: Alternate downloader for a list of PDF links.
- `extract.texts.py`: Extracts full text from PDFs and saves it to `martens_texts.csv`.
- `scrape_summaries.py`: Scrapes metadata and summaries from article pages using BeautifulSoup. These outputs were used for manual reference and exploratory analysis but are not integrated into the final pipeline.

These scripts allow you to regenerate the dataset if the structure of `martens_texts.csv` is lost or if new papers are added in the future.

---

## Input Data

- `martens_texts.csv` — Full-text of Martens Centre policy papers (preprocessed)

---

## Tools & Methodology

| Tools                         | Description |
|------------------------------------|-------------|
| `SentenceTransformers`             | Generates semantic vector embeddings for article texts and predefined themes |
| `cosine_similarity`                | Measures semantic similarity between article embeddings and theme embeddings |
| `AgglomerativeClustering` (`ward` + `euclidean`) | Groups similar articles based on embedding distances into interpretable macro-clusters |
| `matplotlib`, `seaborn`            | Produces visualisations (dendrograms, heatmaps, bar charts) for thematic and cluster analysis |
| `wordcloud`                        | Generates a visual summary of frequently occurring key terms |
| `BeautifulSoup`, `requests`       | Web scraping of article metadata and summaries from policy portals |
| `pandas`, `numpy`                  | Data wrangling, summary statistics, and cluster assignment logic |


---

## Outputs

The following outputs are generated by the scripts and notebook:

**Tables (`data/`)**
- `martens_texts.csv`: Full text dataset with filenames and metadata.
- `papers.csv`: Dataset with papers and their IDs
- `wmc_summaries.csv`: Scraped summaries per document.
- `links.csv`: Source URLs and metadata for each article.
- `text_descriptives_summary.csv`: Document-level stats (word count, sentence count, etc.).
- `paper_top_words.csv`: Top 20 most frequent words per article (paper_id, word, count).
- `top_words_frequency.csv`: Total frequency of all top words across corpus.
- `theme_words.csv`: Theme and keyword mapping (each row is one keyword per theme).
- `theme_counts.csv`: Frequency of each theme across corpus.
- `paper_theme_table.csv`: Long-format table linking each paper to its identified themes.
- `theme_clusters.csv`: Theme and cluster mapping with IDs and names.
- `cluster.csv`: Cluster-level summary with theme groupings and total article count.
- `top_representative_papers`: List of papers with calculated scores for how well they match their assigned cluster.

**Visuals (`images/`)**
- `hierarchical_clustering_dendrogram.png`: Document similarity visualized as a dendrogram.
- `theme_cooccurrence_heatmap.png`: Heatmap of co-occurring themes across documents.
- `theme_frequency_heatmap.png`: Raw frequency of each theme.
- `theme_frequency_within_clusters.png`: Theme frequency broken down by cluster.
- `wordcloud.png`: Word cloud of top keywords in the corpus.

---

## Theming

Themes were grouped into 5 higher-level clusters:

1. **Society, Politics & Information Order**
2. **Geopolitics & Strategic Regions**
3. **Economy, Energy & Innovation**
4. **Social Europe & Labour Dynamics**
5. **Defence & Transatlantic Security**

Each theme was mapped to keywords and matched via semantic similarity to papers.

---

## SQL 
To supplement the analysis pipeline, a relational SQL database (wmc_data) was created from the exported CSVs. 

This allows structured querying of the final dataset, showcasing proper data modeling, foreign key constraints, and query logic. Highlights include:


## How to Use

1. Clone this repository
2. Open `Analysis.ipynb` in JupyterLab or VSCode
3. Run cells top to bottom — intermediate `.csv` and `.png` files are saved automatically

---

## Author

**Edvardas Lukošius**  
Vilnius, Lithuania  

